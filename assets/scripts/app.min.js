"use strict";

var app = {
  pathToLibsFiles: './assets/libs'
};
window.app = app; // polyfills
// before polyfills

(function (arr) {
  arr.forEach(function (item) {
    if (item.hasOwnProperty('before')) {
      return;
    }

    Object.defineProperty(item, 'before', {
      configurable: true,
      enumerable: true,
      writable: true,
      value: function before() {
        // eslint-disable-next-line prefer-rest-params
        var argArr = Array.prototype.slice.call(arguments);
        var docFrag = document.createDocumentFragment();
        argArr.forEach(function (argItem) {
          var isNode = argItem instanceof Node;
          docFrag.appendChild(isNode ? argItem : document.createTextNode(String(argItem)));
        });
        this.parentNode.insertBefore(docFrag, this);
      }
    });
  });
})([Element.prototype, CharacterData.prototype, DocumentType.prototype]); // forEach polyfill


if (window.NodeList && !NodeList.prototype.forEach) {
  NodeList.prototype.forEach = function (callback, thisArg) {
    // eslint-disable-next-line no-param-reassign
    thisArg = thisArg || window;

    for (var i = 0; i < this.length; i++) {
      callback.call(thisArg, this[i], i, this);
    }
  };
}

var preLoader = function preLoader() {
  var mask = document.querySelector('.mask');
  var loader = document.querySelector('.loader'); // setTimeout(() => {
  //   loader.style.width = '25%';
  // }, 300);
  // setTimeout(() => {
  //   loader.style.width = '50%';
  // }, 500);
  // setTimeout(() => {
  //   loader.style.width = '75%';
  // }, 700);

  window.addEventListener('load', function () {
    if (loader) {
      loader.style.width = '100%';
      setTimeout(function () {
        mask.style.display = 'none';
      }, 1000);
    }
  });
};

preLoader();

var toggleMenu = function toggleMenu() {
  var headerMenu = document.querySelector('.header-menu');
  var header = document.querySelector('.header');
  var menu = document.getElementById('menu');
  var headerLinks = document.querySelectorAll('.header-links');
  var logoImg = document.querySelector('.logo-img');
  var menuSymbolBtn = document.querySelector('.menu-symbol-btn');
  var menuTitleBtn = document.querySelector('.menu-title-btn');

  var openMenu = function openMenu() {
    setTimeout(function () {
      logoImg.src = 'assets/images/menu-logo.svg';
      menuSymbolBtn.textContent = '-';
      menuTitleBtn.textContent = menuTitleBtn.dataset.openMenu;
      document.querySelector('html').style.overflow = 'hidden';
    }, 500);
    headerMenu.classList.add('visible');
    headerLinks.forEach(function (item) {
      return item.classList.add('visible');
    });
  };

  var closeMenu = function closeMenu() {
    if (logoImg.classList.contains('img-black')) {
      logoImg.src = 'assets/images/menu-logo.svg';
    } else {
      logoImg.src = 'assets/images/logo.svg';
    }

    headerMenu.classList.remove('visible');
    headerLinks.forEach(function (item) {
      return item.classList.remove('visible');
    });
    menuSymbolBtn.textContent = '+';
    menuTitleBtn.textContent = menuTitleBtn.dataset.closeMenu;
    document.querySelector('html').style.overflow = 'visible';
  };

  header.addEventListener('click', function (e) {
    if (e.target.closest('.header-menu')) {
      menu.classList.toggle('visible');

      if (menu.classList.contains('visible')) {
        openMenu();
      } else {
        closeMenu();
      }
    }
  });
};

toggleMenu();

var footerHover = function footerHover() {
  var footerLink = document.querySelector('.footer-link');
  var footer = document.querySelector('.footer');
  var icon = document.querySelector('.fa-heart');
  var bw = document.body.clientWidth;

  if (bw > 1200) {
    footerLink.addEventListener('mouseover', function () {
      footer.style.backgroundColor = '#c81947';
      icon.style.color = '#fff';
    });
    footerLink.addEventListener('mouseout', function () {
      footer.style.backgroundColor = '#0f0d0e';
      icon.style.color = '#c81947';
    });
  }
};

footerHover();

var toggleOrderPopup = function toggleOrderPopup() {
  var headerOrder = document.querySelector('.header-order');
  var orderPopup = document.querySelector('.order-popup');
  var closeOrderPopup = document.querySelector('.close-order-popup');
  var orderPopupContent = document.querySelector('.order-popup-content');
  var moldingBtn = document.querySelector('.molding-btn');
  var goodsItemImg = document.querySelectorAll('.goods-item__img');
  var goodItemTitle = document.querySelectorAll('.good-item__title');
  var orderPopupSuccess = document.querySelector('.order-popup-success');
  var serviceAdvBtn = document.querySelector('.service-adv__btn');
  var duplicateDescriptionBtn = document.querySelector('.duplicate-description__btn');
  var duplicateTabBtn = document.querySelector('.duplicate-tab__btn');
  var contentItemSubtitleLink = document.querySelector('.content-item__subtitle-link');
  var input = document.querySelector('input[name="product"]');
  var orderPopupTitle = document.querySelector('.order-popup-title');
  var closeOrderPopupSubmit = document.querySelector('.close-order-popup__submit');
  var count = 0;
  var popupInterval;
  var currentLoc = window.location;

  var popupAnimate = function popupAnimate() {
    popupInterval = requestAnimationFrame(popupAnimate);
    orderPopupContent.style.right = count;

    if (count === 0) {
      cancelAnimationFrame(popupInterval);
    }
  };

  var openOrderPopup = function openOrderPopup() {
    orderPopup.style.display = 'block';
    popupInterval = requestAnimationFrame(popupAnimate);
    document.querySelector('html').style.overflow = 'hidden';
  };

  if (goodsItemImg) {
    goodsItemImg.forEach(function (item) {
      item.addEventListener('click', function () {
        input.value = item.dataset.title;
        openOrderPopup();
        orderPopupTitle.textContent = orderPopupTitle.dataset.formTitle;
      });
    });
  }

  if (goodItemTitle) {
    goodItemTitle.forEach(function (item) {
      item.addEventListener('click', function (e) {
        input.value = e.target.dataset.title;
        openOrderPopup();
        orderPopupTitle.textContent = orderPopupTitle.dataset.formTitle;
      });
    });
  }

  if (moldingBtn) {
    moldingBtn.addEventListener('click', function () {
      openOrderPopup();
      input.value = moldingBtn.dataset.formTitle;
      orderPopupTitle.textContent = orderPopupTitle.dataset.formTitle;
    });
  }

  if (contentItemSubtitleLink) {
    contentItemSubtitleLink.addEventListener('click', function () {
      openOrderPopup();
    });
  }

  if (duplicateTabBtn) {
    duplicateTabBtn.addEventListener('click', function () {
      openOrderPopup();
      input.value = duplicateTabBtn.dataset.formTitle;
      orderPopupTitle.textContent = orderPopupTitle.dataset.formTitle;
    });
  }

  if (duplicateDescriptionBtn) {
    duplicateDescriptionBtn.addEventListener('click', function () {
      openOrderPopup();
      orderPopupTitle.textContent = orderPopupTitle.dataset.formTitle;
      input.value = duplicateDescriptionBtn.dataset.formTitle;
    });
  }

  if (serviceAdvBtn) {
    serviceAdvBtn.addEventListener('click', function () {
      openOrderPopup();

      if (currentLoc.pathname.includes('/cutting')) {
        input.value = serviceAdvBtn.dataset.formCuttingtitle;
      } else {
        input.value = serviceAdvBtn.dataset.formTitle;
      }
    });
  }

  headerOrder.addEventListener('click', function () {
    openOrderPopup();
    orderPopupTitle.textContent = orderPopupTitle.dataset.formTitle;
  });
  closeOrderPopup.addEventListener('click', function () {
    orderPopup.style.display = 'none';
    orderPopupContent.removeAttribute('style');
    document.querySelector('html').style.overflow = 'visible';
    orderPopupSuccess.style.display = 'none';
    input.value = '';
    orderPopupTitle.textContent = '';
  });
  closeOrderPopupSubmit.addEventListener('click', function () {
    orderPopup.style.display = 'none';
    orderPopupContent.removeAttribute('style');
    document.querySelector('html').style.overflow = 'visible';
    orderPopupSuccess.style.display = 'none';
    input.value = '';
    orderPopupTitle.textContent = '';
  });
};

toggleOrderPopup();

var toggleTablePopup = function toggleTablePopup() {
  var tablePopup = document.querySelectorAll('.table-popup');
  var goodsItemTable = document.querySelectorAll('.goods-item__table');
  var goods = document.querySelector('.goods'); // const openTable = (index) => {
  //   for (let i = 0; i <= tablePopup.length; i++) {
  //     if (index === i) {
  //       tablePopup[i].style.display = 'block';
  //     }
  //   }
  // }

  if (goods) {
    goods.addEventListener('click', function (e) {
      /* eslint-disable-next-line */
      var target = e.target;
      goodsItemTable.forEach(function (item) {
        if (target === item) {
          tablePopup.forEach(function (tableItem) {
            /* eslint-disable-next-line */
            if (tableItem.id === item.dataset.id) {
              /* eslint-disable-next-line */
              tableItem.style.display = 'block';
            }
          });
        }
      });
    });
  }

  if (tablePopup) {
    tablePopup.forEach(function (item) {
      item.addEventListener('click', function (e) {
        if (e.target.closest('.close-table-popup')) {
          /* eslint-disable-next-line */
          item.style.display = 'none';
        }
      });
    });
  }
};

toggleTablePopup();

var animations = function animations() {
  var bw = document.body.clientWidth;
  gsap.registerPlugin(ScrollTrigger);
  gsap.defaults({
    ease: 'none'
  });
  var white = document.querySelectorAll('.white');
  var black = document.querySelectorAll('.black');
  var test = document.querySelector('.test');
  var goods = document.querySelector('.foam-goods');
  var aboutCollection = document.querySelector('.about-collection');
  var aboutCompanyDescription = document.querySelector('.about-company-description'); // const panel = document.querySelectorAll('.panel');

  white.forEach(function (item) {
    ScrollTrigger.create({
      trigger: item,
      start: 'top 120px',
      end: 'top 120px',
      onEnter: function onEnter() {
        $('.header-links').addClass('header-links-black');
        $('.header-menu').addClass('btn-black');
        document.querySelector('.logo-img').src = 'assets/images/menu-logo.svg';
      },
      onEnterBack: function onEnterBack() {
        $('.header-links').removeClass('header-links-black');
        $('.header-menu').removeClass('btn-black');
        document.querySelector('.logo-img').src = 'assets/images/logo.svg';
      }
    });
  });
  black.forEach(function (item) {
    ScrollTrigger.create({
      trigger: item,
      start: 'top 120px',
      end: 'top 120px',
      onEnter: function onEnter() {
        $('.header-links').removeClass('header-links-black');
        $('.header-links-black').addClass('header-links');
        $('.header-menu').removeClass('btn-black');
        document.querySelector('.logo-img').src = 'assets/images/logo.svg';
      },
      onEnterBack: function onEnterBack() {
        $('.header-links').addClass('header-links-black');
        $('.header-menu').addClass('btn-black');
        document.querySelector('.logo-img').src = 'assets/images/menu-logo.svg';
      }
    });
  });

  if (test) {
    ScrollTrigger.create({
      trigger: test,
      start: 'top 120px',
      end: 'top 120px',
      onEnter: function onEnter() {
        $('.header-links').addClass('header-links-black');
        $('.header-menu').addClass('btn-black');
        document.querySelector('.logo-img').src = 'assets/images/menu-logo.svg';
      },
      onEnterBack: function onEnterBack() {
        $('.header-links').removeClass('header-links-black');
        $('.header-menu').removeClass('btn-black');
        document.querySelector('.logo-img').src = 'assets/images/logo.svg';
      }
    });
  } // ScrollTrigger.create({
  //   trigger: '.hidden-header',
  //   start: 'top 120px',
  //   end: 'top 120px',
  //   onEnter: () => {
  //     $('.header-wht').addClass('hidden');
  //   },
  //   onEnterBack: () => {
  //     $('.header-wht').removeClass('hidden');
  //   },
  // });


  if (bw > 1024) {
    /* eslint-disable-next-line */
    $('.container-animate').map(function (index, element) {
      gsap.to($(element), {
        scrollTrigger: {
          trigger: $(element),
          start: 'top bottom',
          end: '50% 50%',
          scrub: 1
        },
        opacity: 1
      });
    });
    /* eslint-disable-next-line */

    $('.container-animate-wrapper').map(function (index, element) {
      gsap.to($(element), {
        scrollTrigger: {
          trigger: $(element),
          start: '50% top',
          end: 'bottom top',
          scrub: 1
        },
        opacity: 0
      });
    });
    gsap.to($('.about-company__img-block')[0], {
      scrollTrigger: {
        trigger: $('.about-company .container-animate'),
        start: 'top bottom',
        end: '50% 50%',
        scrub: 1
      },
      translateY: 0
    });
    gsap.utils.toArray('.panel').forEach(function (panel) {
      ScrollTrigger.create({
        trigger: panel,
        start: 'top top',
        pin: true,
        pinSpacing: false
      });
    });

    if (aboutCollection) {
      ScrollTrigger.create({
        trigger: aboutCollection,
        start: 'top 120px',
        end: 'top 120px',
        onEnter: function onEnter() {
          $('#header').removeClass('bg');
          $('#header').removeClass('bg');
        },
        onEnterBack: function onEnterBack() {
          $('#header').addClass('bg');
          $('#header').addClass('bg');
        }
      });
    }

    if (goods) {
      ScrollTrigger.create({
        trigger: goods,
        start: 'top 120px',
        end: 'top 120px',
        onEnter: function onEnter() {
          $('#header').addClass('bg');
          $('#header').addClass('bg');
        },
        onEnterBack: function onEnterBack() {
          $('#header').removeClass('bg');
          $('#header').removeClass('bg');
        }
      });
    }

    if (aboutCompanyDescription) {
      ScrollTrigger.create({
        trigger: aboutCompanyDescription,
        start: 'top 120px',
        end: 'top 120px',
        onEnter: function onEnter() {
          $('#header').addClass('bg');
          $('#header').addClass('bg');
        },
        onEnterBack: function onEnterBack() {
          $('#header').removeClass('bg');
          $('#header').removeClass('bg');
        }
      });
    }
  }
};

window.onload = function () {
  ScrollTrigger.refresh();
  var pictureObserver = lozad('.lozad', {
    threshold: 0.1
  });
  pictureObserver.observe();
};

animations();

var slider = function slider() {
  /* eslint-disable-next-line */
  var swiper = new Swiper('.swiper', {
    slidesPerView: 4.5,
    breakpoints: {
      320: {
        spaceBetween: 10,
        slidesPerView: 2
      },
      577: {
        spaceBetween: 16,
        slidesPerView: 2,
        slidesPerGroup: 2
      },
      768: {
        spaceBetween: 30,
        slidesPerView: 3
      },
      1201: {
        spaceBetween: 65,
        slidesPerView: 4
      }
    }
  });
};

slider();

var footerSlider = function footerSlider() {
  /* eslint-disable-next-line */
  var possibilitiesSlider;
  /* eslint-disable-next-line */

  possibilitiesSlider = new Swiper('.footer-slider', {
    slidesPerView: 6,
    slidesPerGroup: 6,
    spaceBetween: 20,
    breakpoints: {
      320: {
        slidesPerView: 4,
        slidesPerGroup: 4,
        spaceBetween: 20
      },
      440: {
        slidesPerView: 5,
        slidesPerGroup: 5,
        spaceBetween: 20
      },
      576: {
        slidesPerView: 6,
        slidesPerGroup: 6,
        spaceBetween: 20
      }
    }
  });
};

footerSlider(); // function maskPhone(selector, masked = '+375 (__) ___-__-__') {
//   const elems = document.querySelectorAll(selector);
//   function mask(event) {
//     /* eslint-disable-next-line */
//     const keyCode = event.keyCode;
//     const template = masked;
//     const def = template.replace(/\D/g, '');
//     const val = this.value.replace(/\D/g, '');
//     let i = 0;
//     /* eslint-disable-next-line */
//     let newValue = template.replace
//     (/[_\d]/g, a => (i < val.length ? val.charAt(i++) || def.charAt(i) : a));
//     i = newValue.indexOf('_');
//     if (i !== -1) {
//       newValue = newValue.slice(0, i);
//     }
//     /* eslint-disable-next-line */
//     let reg = template.substr(0, this.value.length)
//      .replace(/_+/g, a => '\\d{1,' + a.length + '}').replace(/[+()]/g, '\\$&');
//     /* eslint-disable-next-line */
//     reg = new RegExp('^' + reg + '$');
//     /* eslint-disable-next-line */
//     if (!reg.test(this.value) || this.value.length < 5 || keyCode > 47 && keyCode < 58) {
//       this.value = newValue;
//     }
//     if (event.type === 'blur' && this.value.length < 5) {
//       this.value = '';
//     }
//   }
//   /* eslint-disable-next-line */
//   for (const elem of elems) {
//     elem.addEventListener('input', mask);
//     elem.addEventListener('focus', mask);
//     elem.addEventListener('blur', mask);
//   }
// }
// // use
// maskPhone('input[name="phone"]');

var validationForm = function validationForm() {
  var orderPopupForm = document.querySelector('.order-popup-form');
  orderPopupForm.addEventListener('input', function (e) {
    if (e.target.matches('input[name="name"]')) {
      if (e.target.value.length <= 20) {
        e.target.value = e.target.value.replace(/[^\D]/, '');
      } else {
        e.target.value = '';
      }
    }

    if (e.target.matches('input[name="email"]')) {
      if (e.target.value.length >= 50) {
        e.target.value = '';
      } else {
        /* eslint-disable-next-line */
        e.target.value = e.target.value.replace(/[А-яЁё]/, '');
      }
    }

    if (e.target.matches('input[name="phone"]')) {
      if (e.target.value.length >= 30) {
        e.target.value = '';
      } else {
        /* eslint-disable-next-line */
        e.target.value = e.target.value.replace(/[^+?][^(0-9)\s]/g, '');
      }
    }

    if (e.target.matches('input[name="product"]')) {
      if (e.target.value.length <= 30) {
        e.target.value = e.target.value.replace(/[^\D]/, '');
      } else {
        e.target.value = '';
      }
    }

    if (e.target.matches('input[name="message"]')) {
      if (e.target.value.length >= 500) {
        e.target.value = '';
      }
    }
  });
};

validationForm(); // const submitBtn = () => {
//   const orderPopupBtn = document.querySelector('.order-popup__btn');
//   const orderPopupSuccess = document.querySelector('.order-popup-success');
//   const closeOrderPopupSubmit = document.querySelector('.close-order-popup__submit');
//   const orderPopup = document.querySelector('.order-popup');
//   orderPopupBtn.addEventListener('click', () => {
//     orderPopupSuccess.style.display = 'block';
//   });
//   closeOrderPopupSubmit.addEventListener('click', () => {
//     orderPopup.style.display = 'none';
//     orderPopupSuccess.style.display = 'none';
//     document.querySelector('html').style.overflow = 'visible';
//   });
// };
// submitBtn();

var goodsHover = function goodsHover() {
  var goods = document.querySelector('.goods');
  var backdrop = document.querySelector('.backdrop');
  var bw = document.body.clientWidth;

  if (goods) {
    if (bw > 1050) {
      goods.addEventListener('mouseover', function (e) {
        if (e.target.closest('.goods-item')) {
          var target = e.target.closest('.goods-item');
          backdrop.classList.add('active');
          target.classList.add('active');
        }
      });
      goods.addEventListener('mouseout', function (e) {
        if (e.target.closest('.goods-item')) {
          var target = e.target.closest('.goods-item');
          backdrop.classList.remove('active');
          target.classList.remove('active');
        }
      });
    }
  }
};

goodsHover();

var duplicateSlider = function duplicateSlider() {
  /* eslint-disable-next-line */
  var duplicatSlider = new Swiper('.duplicate-slider', {
    slidesPerView: 1,
    slidesPerGroup: 1,
    speed: 600,
    loop: true,
    navigation: {
      nextEl: '.next',
      prevEl: '.prev'
    }
  });
};

duplicateSlider();

var toggleSubMenu = function toggleSubMenu() {
  var openHelpMenu = document.querySelector('.open-help-menu');
  var navLinkList = document.querySelector('.nav-link__list');
  openHelpMenu.addEventListener('click', function () {
    openHelpMenu.classList.toggle('active');
    navLinkList.classList.toggle('active');
  });
};

toggleSubMenu();

var hideText = function hideText() {
  var str = document.querySelectorAll('.collection-item__text');
  str.forEach(function (item) {
    var strContent = item.textContent;

    if (strContent.length > 300) {
      /* eslint-disable-next-line */
      var cutText = strContent.slice(0, 300) + '...';
      /* eslint-disable-next-line */

      item.textContent = cutText;
    }

    item.addEventListener('click', function (e) {
      var targetText = e.target.closest('.collection-item__text');

      if (item === targetText) {
        /* eslint-disable-next-line */
        if (strContent.length > 300) {
          /* eslint-disable-next-line */
          var _cutText = strContent.slice(0, 1000);
          /* eslint-disable-next-line */


          item.textContent = _cutText;
        }
      }
    });
  });
};

hideText();
app.yourScriptName = {
  name: 'yourScriptName',
  description: 'your script description',
  init: function init() {// your code
  }
};
app.addLibs = {
  name: 'addLibs',
  description: 'connect the script library dynamically',
  addScriptFile: function addScriptFile(nameFile, callback) {
    var body = document.getElementsByTagName('body')[0];
    var script = document.createElement('script');

    script.onload = function () {
      return callback && callback();
    };

    script.src = "".concat(app.pathToLibsFiles, "/js/").concat(nameFile, ".js");
    body.appendChild(script);
  },
  addStyleFile: function addStyleFile(nameFile) {
    var appCss = document.getElementById('app-css');
    var link = document.createElement('link');
    link.rel = 'stylesheet';
    link.href = "".concat(app.pathToLibsFiles, "/css/").concat(nameFile, ".css");
    appCss.before(link);
  },
  initScript: function initScript(nameFile, nameLib, callback) {
    var hasLibs = null;
    var scripts = document.querySelectorAll('script');
    scripts.forEach(function (el) {
      var str = el.getAttribute('src');

      if (str) {
        if (str.indexOf(nameFile) >= 0) {
          hasLibs = true;
        }
      }
    });

    if (!hasLibs) {
      this.addScriptFile(nameFile, callback);
    } else {
      var timerId = setInterval(function () {
        if (window[nameLib] || window.jQuery && jQuery()[nameLib]) {
          callback();
          clearInterval(timerId);
        }
      }, 1);
    }
  },
  initStyle: function initStyle(nameFile) {
    var hasLibs = null;
    var link = document.querySelectorAll('link');
    link.forEach(function (el) {
      var str = el.getAttribute('src');

      if (str) {
        if (str.indexOf(nameFile) >= 0) {
          hasLibs = true;
        }
      }
    });

    if (!hasLibs) {
      this.addStyleFile(nameFile);
    }
  }
}; // app.yourScriptName.init();
//# sourceMappingURL=app.min.js.map
